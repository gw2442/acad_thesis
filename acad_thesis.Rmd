---
title: "acad_thesis"
output: html_document
date: "2023-03-28"
---

```{r}
library(dplyr)
library(tidyverse)
library(epitab)
library(rstatix)
library(ggplot2)
library(broom)
library(tableone)
```

## Importing and cleaning data

```{r}
acad_data = read_csv(file = "./data/REDCAP.csv") %>%
  janitor::clean_names() 
  skimr::skim(acad_data)
```

The CSV file was downloaded from the ACAD dataset. The dataset `acad_data` has 327 observations and 660 variables. Of the 660 varaibles, 491 are character variables, 70 are logical, and 99 are numeric. The relevant variables were then selected for further cleaning.

```{r, eval = FALSE}
acad_clean = acad_data %>%
  select(
    "acad_id", "degree", "gender", "country_a", "generation", 
    
    "parta_a201", "parta_a202", "parta_a203", "parta_a204", "parta_a205", "parta_a206", "parta_a207", "parta_a208", "parta_a209", "parta_a210", "parta_a211", "parta_a212", "parta_a213", "parta_a214", "parta_a2score",
    
    "memory", "orient", "judgment", "commun", "homehobb", "perscare", "cdr_sum", "cdrglob", "comport", "cdrlang",
    
    "bills", "taxes", "shopping", "games", "stove", "mealprep", "events", "payattn", "remdates", "travel", "fas", 
    
    "clock1", "clock2", "clock3", "clock4", "clock5", "clock6", "clock7", "clock8", "clock9", "clock10", "clock11", "clock12", "clock13", "clock14", "clock15", "clock_t",
    
    "word1_t1", "word2_t1", "word3_t1", "word4_t1", "word5_t1", "word6_t1", "word7_t1", "word8_t1", "word9_t1", "word10_t1", "comt_t1","word1_t2", "word2_t2", "word3_t2", "word4_t2", "word5_t2", "word6_t2", "word7_t2", "word8_t2", "word9_t2", "word10_t2", "comt_t2", "word1_t3", "word2_t3", "word3_t3", "word4_t3", "word5_t3", "word6_t3", "word7_t3", "word8_t3", "word9_t3", "word10_t3", "comt_t3","word1_d", "word2_d", "word3_d", "word4_d", "word5_d", "word6_d", "word7_d", "word8_d", "word9_d", "word10_d", "comt_d", "item1", "item2", "item3", "item4", "item5", "item6", "item7", "item8", "item9", "item10", "word1_dr", "word2_dr", "word3_dr", "word4_dr", "word5_dr", "word6_dr", "word7_dr", "word8_dr","word9_dr", "word10_dr", "comt_dr",
    
    "condition1", "condition2", "condition3", "condition4", "condition5", "condition6", "condition7", "condition8", "condition9", "condition10", "condition11", "condition12", "condition13", "condition14", "condition15"
  ) %>%
  mutate(
    degree = factor(
      #age
      degree, levels = c("Grade school or less", 
                                       "Some high school", 
                                       "High school or G.E.D.", 
                                       "Graduate degree (Master's, Doctoral, or Professional degree)")),
    #gender
    country_a = as.character(country_a),
    country_a = recode(country_a, 
                       "156" = "China", 
                       "410" = "South Korea", 
                       "124" = "Canada", 
                       "344" = "Hong Kong", 
                       "158" = "Taiwan", 
                       "360" = "Indonesia", 
                       "458" = "Malaysia", 
                       "888" = "Other", 
                       "704" = "Vietnam" ),    
    generation = factor(generation, labels = c("1st", 
                                               "2nd", 
                                               "3rd", 
                                               "4th")),
    parta_a202 = recode(parta_a202,
                        "0 No" = 0,
                        "1 Yes" = 1),
    parta_a203 = recode(parta_a203,
                        "0 No" = 0,
                        "1 Yes" = 1),
    parta_a204 = recode(parta_a204,
                        "0 No" = 0,
                        "1 Yes" = 1),
    parta_a205 = recode(parta_a205,
                        "0 No" = 0,
                        "1 Yes" = 1),
    parta_a206 = recode(parta_a206,
                        "0 No" = 0,
                        "1 Yes" = 1),
    parta_a207 = recode(parta_a207,
                        "0 No" = 0,
                        "1 Yes" = 1),
    parta_a208 = recode(parta_a208,
                        "0 No" = 0,
                        "1 Yes" = 1),
    parta_a209 = recode(parta_a209,
                        "0 No" = 0,
                        "1 Yes" = 1),
    parta_a210 = recode(parta_a210,
                        "0 No" = 0,
                        "1 Yes" = 1),
    parta_a211 = recode(parta_a211,
                        "0 No" = 0,
                        "1 Yes" = 1),
    parta_a212 = recode(parta_a212,
                        "0 No" = 0,
                        "1 Yes" = 1),
    parta_a213 = recode(parta_a213,
                        "0 No" = 0,
                        "1 Yes" = 1),
    parta_a214 = recode(parta_a214,
                        "0 No" = 0,
                        "1 Yes" = 1),
    parta_a201 = ifelse(is.na(parta_a201), 0, parta_a201),
    parta_a202 = ifelse(is.na(parta_a202), 0, parta_a202),
    parta_a203 = ifelse(is.na(parta_a203), 0, parta_a203),
    parta_a204 = ifelse(is.na(parta_a204), 0, parta_a204),
    parta_a205 = ifelse(is.na(parta_a205), 0, parta_a205),
    parta_a206 = ifelse(is.na(parta_a206), 0, parta_a206),
    parta_a207 = ifelse(is.na(parta_a207), 0, parta_a207),
    parta_a208 = ifelse(is.na(parta_a208), 0, parta_a208),
    parta_a209 = ifelse(is.na(parta_a209), 0, parta_a209),
    parta_a210 = ifelse(is.na(parta_a210), 0, parta_a210),
    parta_a211 = ifelse(is.na(parta_a211), 0, parta_a211),
    parta_a212 = ifelse(is.na(parta_a212), 0, parta_a212),
    parta_a213 = ifelse(is.na(parta_a213), 0, parta_a213),
    parta_a214 = ifelse(is.na(parta_a214), 0, parta_a214),
    parta_a2score = parta_a201 + parta_a202 + parta_a203 + parta_a204 + parta_a205 + parta_a206 + parta_a207 + parta_a208 + parta_a209 + parta_a210 + parta_a211 + parta_a212 + parta_a213 + parta_a214,
    memory = recode(memory, 
                    "Moderate - 2 Severe memory loss; only highly learned material retained; new material rapidly lost." = 2),
    orient = recode(orient,
                    "None - 0 Fully oriented" = 0,
                    "Questionable - 0.5 Fully oriented except for slight difficulty with time relationships." = 0.5,
                    "Mild - 1 Moderate difficulty with time relationships; oriented for place at examination; may have geographic disorientation elsewhere." = 1,
                    "Moderate - 2 Severe difficulty with time relationships; usually disoriented to time, often to place." = 2,
                    "Severe - 3 Oriented to person only." = 3),
    judgment = recode(judgment,
                       "None - 0 Solves everyday problems, handles business & financial affairs well; judgment good in relation to past performance." = 0,
                      "Questionable - 0.5 Slight impairment in solving problems, similarities, and differences." = 0.5,
                      "Mild - 1 Moderate difficulty in handling problems, similarities, and differences; social judgment usually maintained." = 1,
                      "Moderate - 2 Severely impaired in handling problems, similarities, and differences; social judgment usually impaired." = 2,
                      "Severe - 3 Unable to make judgments or solve problems." = 3),
    commun = recode(commun,
                    "None - 0 Independent function at usual level in job, shopping, volunteer and social groups." = 0,
                    "Questionable - 0.5 Slight impairment in these activities." = 0.5,
                    "Mild - 1 Unable to function independently at these activities, although may still be engaged in some; appears normal to casual inspection." = 1,
                    "Moderate - 2 No pretense of independent function outside the home; appears well enough to be taken to functions outside the family home." = 2,
                    "Severe - 3 No pretense of independent function outside the home; appears too ill to be taken to functions outside the family home." = 3),
    homehobb = recode(homehobb,
                      "None - 0 Life at home, hobbies, and intellectual interests well maintained." = 0,
                      "Questionable - 0.5 Life at home, hobbies, and intellectual interests slightly impaired." = 0.5,
                      "Mild - 1 Mild but definite impairment of function at home; more difficult chores abandoned; more complicated hobbies and interests abandoned." = 1,
                      "Moderate - 2 Only simple chores preserved; very restricted interests, poorly maintained." = 2,
                      "Severe - 3 No significant function in the home." = 3),
    perscare = recode(perscare, 
                      "None / Questionable - 0Fully capable of self-care (=0)." = 0,
                      "0.5" = 0.5,
                      "Mild - 1 Needs prompting." = 1,
                      "Moderate - 2 Requires assistance in dressing, hygiene, keeping of personal effects." = 2,
                      "Severe - 3 Requires much help with personal care; frequent incontinence." = 3),
    memory = ifelse(is.na(memory), 0, memory),
    orient = ifelse(is.na(orient), 0, orient),
    judgment = ifelse(is.na(judgment), 0, judgment),
    commun = ifelse (is.na(commun), 0, commun),
    homehobb= ifelse(is.na(homehobb), 0, homehobb),
    perscare = ifelse(is.na(perscare), 0, perscare),
    cdr_sum = memory + orient + judgment + commun + homehobb + perscare,
    #cdrglob 
    comport = recode(comport,
                     "None - 0Socially appropriate behavior." = 0,
                     "Questionable - 0.5Questionable changes in comportment, empathy, appropriateness of actions." = 0.5,
                     "Mild - 1Mild but definite changes in behavior." = 1,
                     "Moderate - 2Moderate behavioral changes, affecting interpersonal relationships and interactions in a significant manner." = 2,
                     "Severe - 3Severe behavioral changes, making interpersonal interactions all unidirectional." = 3),
    cdrlang = recode(cdrlang,
                     "None - 0 No language difficulty or occasional mild tip-of-the-tongue." = 0,
                     "Questionable - 0.5Consistent mild word finding difficulties; simplification of word choice; circumlocution; decreased phrase length; and/or mild comprehension difficulties." = 0.5,
                     "Mild - 1Moderate word finding difficulty in speech; cannot name objects in environment; reduced phrase length and/or agrammatical speech; and/or reduced comprehension in conversation and reading." = 1,
                     "Moderate - 2Moderate to severe impairments in either speech or comprehension; has difficulty communicating thoughts; writing may be slightly more effective." = 2,
                     "Severe - 3Severe comprehension deficits; no intelligible speech." = 3),
    #functional assessment score variables (bills:fas)
    #bills
    taxes = recode(taxes,
                   "0 Never did, but could do now" = 8,
                   "1 Never did and would have difficulty now" = 7,
                   "0 Normal" = 0,
                   "1 Has difficulty, but does by self" = 1,
                   "2 Requires some assistance" = 2,
                   "3 Completely dependent" = 3,
                   "9 Unknown" = 9),
    shopping = recode(shopping,
                   "0 Never did, but could do now" = 8,
                   "1 Never did and would have difficulty now" = 7,
                   "0 Normal" = 0,
                   "1 Has difficulty, but does by self" = 1,
                   "2 Requires some assistance" = 2,
                   "3 Completely dependent" = 3,
                   "9 Unknown" = 9),
    games = recode(games,
                   "0 Never did, but could do now" = 8,
                   "1 Never did and would have difficulty now" = 7,
                   "0 Normal" = 0,
                   "1 Has difficulty, but does by self" = 1,
                   "2 Requires some assistance" = 2,
                   "3 Completely dependent" = 3,
                   "9 Unknown" = 9),
    stove = recode(stove,
                   "0 Never did, but could do now" = 8,
                   "1 Never did and would have difficulty now" = 7,
                   "0 Normal" = 0,
                   "1 Has difficulty, but does by self" = 1,
                   "2 Requires some assistance" = 2,
                   "3 Completely dependent" = 3,
                   "9 Unknown" = 9),
    mealprep = recode(mealprep,
                   "0 Never did, but could do now" = 8,
                   "1 Never did and would have difficulty now" = 7,
                   "0 Normal" = 0,
                   "1 Has difficulty, but does by self" = 1,
                   "2 Requires some assistance" = 2,
                   "3 Completely dependent" = 3,
                   "9 Unknown" = 9),
    events = recode(events,
                   "0 Never did, but could do now" = 8,
                   "1 Never did and would have difficulty now" = 7,
                   "0 Normal" = 0,
                   "1 Has difficulty, but does by self" = 1,
                   "2 Requires some assistance" = 2,
                   "3 Completely dependent" = 3,
                   "9 Unknown" = 9),
    payattn = recode(payattn,
                   "0 Never did, but could do now" = 8,
                   "1 Never did and would have difficulty now" = 7,
                   "0 Normal" = 0,
                   "1 Has difficulty, but does by self" = 1,
                   "2 Requires some assistance" = 2,
                   "3 Completely dependent" = 3,
                   "9 Unknown" = 9),
    remdates = recode(remdates,
                   "0 Never did, but could do now" = 8,
                   "1 Never did and would have difficulty now" = 7,
                   "0 Normal" = 0,
                   "1 Has difficulty, but does by self" = 1,
                   "2 Requires some assistance" = 2,
                   "3 Completely dependent" = 3,
                   "9 Unknown" = 9),
    travel = recode(travel,
                   "0 Never did, but could do now" = 8,
                   "1 Never did and would have difficulty now" = 7,
                   "0 Normal" = 0,
                   "1 Has difficulty, but does by self" = 1,
                   "2 Requires some assistance" = 2,
                   "3 Completely dependent" = 3,
                   "9 Unknown" = 9),
    #fas
    #clock1 variable 
    clock2 = recode(clock2, 
                    "No" = 0,
                    "Yes" = 1),
    clock3 = recode(clock3, 
                    "No" = 0,
                    "Yes" = 1),
    clock4 = recode(clock4, 
                    "No" = 0,
                    "Yes" = 1),
    clock5 = recode(clock5, 
                    "No" = 0,
                    "Yes" = 1),
    clock6 = recode(clock6, 
                    "No" = 0,
                    "Yes" = 1),
    clock7 = recode(clock7, 
                    "No" = 0,
                    "Yes" = 1),
    clock8 = recode(clock8, 
                    "No" = 0,
                    "Yes" = 1),
    clock9 = recode(clock9, 
                    "No" = 0,
                    "Yes" = 1),
    clock10 = recode(clock10, 
                    "No" = 0,
                    "Yes" = 1),
    clock11 = recode(clock11, 
                    "No" = 0,
                    "Yes" = 1),
    clock12 = recode(clock12, 
                    "No" = 0,
                    "Yes" = 1),
    clock13 = recode(clock13, 
                    "No" = 0,
                    "Yes" = 1),
    clock14 = recode(clock14, 
                    "No" = 0,
                    "Yes" = 1),
    clock15 = recode(clock15, 
                    "No" = 0,
                    "Yes" = 1),
    #clock_t score
    #word1_t1 variable
    word2_t1 = recode(word2_t1,
                      "Inaccurate or required prompting for performance" = 0,
                      "Correctly recalled" = 1),
    word3_t1 = recode(word3_t1,
                      "Inaccurate or required prompting for performance" = 0,
                      "Correctly recalled" = 1),
    word4_t1 = recode(word4_t1,
                      "Inaccurate or required prompting for performance" = 0,
                      "Correctly recalled" = 1),
    word5_t1 = recode(word5_t1,
                      "Inaccurate or required prompting for performance" = 0,
                      "Correctly recalled" = 1),
    word6_t1 = recode(word6_t1,
                      "Inaccurate or required prompting for performance" = 0,
                      "Correctly recalled" = 1),
    word7_t1 = recode(word7_t1,
                      "Inaccurate or required prompting for performance" = 0,
                      "Correctly recalled" = 1),
    word8_t1 = recode(word8_t1,
                      "Inaccurate or required prompting for performance" = 0,
                      "Correctly recalled" = 1),
    word9_t1 = recode(word9_t1,
                      "Inaccurate or required prompting for performance" = 0,
                      "Correctly recalled" = 1),
    word10_t1 = recode(word10_t1,
                      "Inaccurate or required prompting for performance" = 0,
                      "Correctly recalled" = 1),
    #comt_t1
    #word8_t2
    word5_t2 = recode(word5_t2,
                      "Inaccurate or required prompting for performance" = 0,
                      "Correctly recalled" = 1),
    word1_t2 = recode(word1_t2,
                      "Inaccurate or required prompting for performance" = 0,
                      "Correctly recalled" = 1),
    word7_t2 = recode(word7_t2,
                      "Inaccurate or required prompting for performance" = 0,
                      "Correctly recalled" = 1),
    word10_t2 = recode(word10_t2,
                      "Inaccurate or required prompting for performance" = 0,
                      "Correctly recalled" = 1),
    word9_t2 = recode(word9_t2,
                      "Inaccurate or required prompting for performance" = 0,
                      "Correctly recalled" = 1),
    word3_t2 = recode(word3_t2,
                      "Inaccurate or required prompting for performance" = 0,
                      "Correctly recalled" = 1),
    word4_t2 = recode(word4_t2,
                      "Inaccurate or required prompting for performance" = 0,
                      "Correctly recalled" = 1),
    word6_t2 = recode(word6_t2,
                      "Inaccurate or required prompting for performance" = 0,
                      "Correctly recalled" = 1),
    word2_t2 = recode(word2_t2,
                      "Inaccurate or required prompting for performance" = 0,
                      "Correctly recalled" = 1),
    #comt_t2
    word1_t3 = recode(word1_t3,
                      "Inaccurate or required prompting for performance." = 0,
                      "Correctly Recalled" = 1),
    word2_t3 = recode(word2_t3,
                      "Inaccurate or required prompting for performance." = 0,
                      "Correctly Recalled" = 1),
    #word3_t3
    word4_t3 = recode(word4_t3,
                      "Inaccurate or required prompting for performance." = 0,
                      "Correctly Recalled" = 1),
    word5_t3 = recode(word5_t3,
                      "Inaccurate or required prompting for performance." = 0,
                      "Correctly Recalled" = 1),
    word6_t3 = recode(word6_t3,
                      "Inaccurate or required prompting for performance." = 0,
                      "Correctly Recalled" = 1),
    word7_t3 = recode(word7_t3,
                      "Inaccurate or required prompting for performance." = 0,
                      "Correctly Recalled" = 1),
    word8_t3 = recode(word8_t3,
                      "Inaccurate or required prompting for performance." = 0,
                      "Correctly Recalled" = 1),
    word9_t3 = recode(word9_t3,
                      "Inaccurate or required prompting for performance." = 0,
                      "Correctly Recalled" = 1),
    word10_t3 = recode(word10_t3,
                      "Inaccurate or required prompting for performance." = 0,
                      "Correctly Recalled" = 1),
    #comt_t3
    #word1_d
    word2_d = recode(word2_d,
                     "inaccurate or required prompting for performance" = 0,
                     "Correctly recalled" = 1),
    word3_d = recode(word3_d,
                     "inaccurate or required prompting for performance" = 0,
                     "Correctly recalled" = 1),
    word4_d = recode(word4_d,
                     "inaccurate or required prompting for performance" = 0,
                     "Correctly recalled" = 1),
    word5_d = recode(word5_d,
                     "inaccurate or required prompting for performance" = 0,
                     "Correctly recalled" = 1),
    word6_d = recode(word6_d,
                     "inaccurate or required prompting for performance" = 0,
                     "Correctly recalled" = 1),
    word7_d = recode(word7_d,
                     "inaccurate or required prompting for performance" = 0,
                     "Correctly recalled" = 1),
    word8_d = recode(word8_d,
                     "inaccurate or required prompting for performance" = 0,
                     "Correctly recalled" = 1),
    word9_d = recode(word9_d,
                     "inaccurate or required prompting for performance" = 0,
                     "Correctly recalled" = 1),
    word10_d = recode(word10_d,
                     "inaccurate or required prompting for performance" = 0,
                     "Correctly recalled" = 1),
    #comt_d
    #item1
    item2 = recode(item2, 
                   "No" = 0,
                   "Yes" = 1),
    item3 = recode(item3, 
                   "No" = 0,
                   "Yes" = 1),
    item4 = recode(item4, 
                   "No" = 0,
                   "Yes" = 1),
    item5 = recode(item5, 
                   "No" = 0,
                   "Yes" = 1),
    item6 = recode(item6, 
                   "No" = 0,
                   "Yes" = 1),
    item7 = recode(item7, 
                   "No" = 0,
                   "Yes" = 1),
    item8 = recode(item8, 
                   "No" = 0,
                   "Yes" = 1),
    item9 = recode(item9, 
                   "No" = 0,
                   "Yes" = 1),
    item10 = recode(item10, 
                   "No" = 0,
                   "Yes" = 1),
    word1_dr = recode(word1_dr,
                      "No" = 0,
                      "Yes" = 1),
    word2_dr = recode(word2_dr,
                      "No" = 0,
                      "Yes" = 1),
    word3_dr = recode(word3_dr,
                      "No" = 0,
                      "Yes" = 1),
    word4_dr = recode(word4_dr,
                      "No" = 0,
                      "Yes" = 1),
    word5_dr = recode(word5_dr,
                      "No" = 0,
                      "Yes" = 1),
    word6_dr = recode(word6_dr,
                      "No" = 0,
                      "Yes" = 1),
    word7_dr = recode(word7_dr,
                      "No" = 0,
                      "Yes" = 1),
    word8_dr = recode(word8_dr,
                      "No" = 0,
                      "Yes" = 1),
    word9_dr = recode(word9_dr,
                      "No" = 0,
                      "Yes" = 1),
    word10_dr = recode(word10_dr,
                      "No" = 0,
                      "Yes" = 1),
    #comt_dr
    condition1 = recode(condition1,
                        "No" = 0,
                        "Yes" = 1,
                        "Don't know (Unsure)" = 55),

    condition2 = recode(condition2,
                        "No" = 0,
                        "Yes" = 1,
                        "Don't know (Unsure)" = 55),
    condition3 = recode(condition3,
                        "No" = 0,
                        "Yes" = 1,
                        "Don't know (Unsure)" = 55),
    condition4 = recode(condition4,
                        "No" = 0,
                        "Yes" = 1,
                        "Don't know (Unsure)" = 55),
    condition5 = recode(condition5,
                        "No" = 0,
                        "Yes" = 1,
                        "Don't know (Unsure)" = 55),
    condition6 = recode(condition6,
                        "No" = 0,
                        "Yes" = 1,
                        "Don't know (Unsure)" = 55),
    condition7 = recode(condition7,
                        "No" = 0,
                        "Yes" = 1,
                        "Don't know (Unsure)" = 55),
    condition8 = recode(condition8,
                        "No" = 0,
                        "Yes" = 1,
                        "Don't know (Unsure)" = 55),
    condition9 = recode(condition9,
                        "No" = 0,
                        "Yes" = 1,
                        "Don't know (Unsure)" = 55),
    condition10 = recode(condition10,
                        "No" = 0,
                        "Yes" = 1,
                        "Don't know (Unsure)" = 55),
    condition11 = recode(condition11,
                        "No" = 0,
                        "Yes" = 1,
                        "Don't know (Unsure)" = 55),
    condition12 = recode(condition12,
                        "No" = 0,
                        "Yes" = 1,
                        "Don't know (Unsure)" = 55),
    condition13 = recode(condition13,
                        "No" = 0,
                        "Yes" = 1,
                        "Don't know (Unsure)" = 55),
    condition14 = recode(condition14,
                        "No" = 0,
                        "Yes" = 1,
                        "Don't know (Unsure)" = 55)
    )

```

----

Raw CSV file used instead due to column misalignment in the first dataset.

```{r}
acad_data = read_csv(file = "./data/ACAD-202301-Columbia-Wei-20230331-raw.csv") %>%
  janitor::clean_names() 
  skimr::skim(acad_data)
```
 
The CSV file was downloaded from the ACAD dataset. The dataset `acad_data` has 311 observations and 665 variables. The relevant variables were then selected for further cleaning.
 
```{r}
acad_clean = acad_data %>%
  select(
    "acad_id", "age","degree", "gender", "country", "generation", 
    
    "parta_a201", "parta_a202", "parta_a203", "parta_a204", "parta_a205", "parta_a206", "parta_a207", "parta_a208", "parta_a209", "parta_a210", "parta_a211", "parta_a212", "parta_a213", "parta_a214", "parta_a2score",
    
    "memory", "orient", "judgment", "commun", "homehobb", "perscare", "cdr_sum", "cdrglob", "comport", "cdrlang",
    
    "bills", "taxes", "shopping", "games", "stove", "mealprep", "events", "payattn", "remdates", "travel", "fas", 
    
    "clock1", "clock2", "clock3", "clock4", "clock5", "clock6", "clock7", "clock8", "clock9", "clock10", "clock11", "clock12", "clock13", "clock14", "clock15", "clock_t",
    
    "word1_t1", "word2_t1", "word3_t1", "word4_t1", "word5_t1", "word6_t1", "word7_t1", "word8_t1", "word9_t1", "word10_t1", "comt_t1","word1_t2", "word2_t2", "word3_t2", "word4_t2", "word5_t2", "word6_t2", "word7_t2", "word8_t2", "word9_t2", "word10_t2", "comt_t2", "word1_t3", "word2_t3", "word3_t3", "word4_t3", "word5_t3", "word6_t3", "word7_t3", "word8_t3", "word9_t3", "word10_t3", "comt_t3","word1_d", "word2_d", "word3_d", "word4_d", "word5_d", "word6_d", "word7_d", "word8_d", "word9_d", "word10_d", "comt_d", "item1", "item2", "item3", "item4", "item5", "item6", "item7", "item8", "item9", "item10", "word1_dr", "word2_dr", "word3_dr", "word4_dr", "word5_dr", "word6_dr", "word7_dr", "word8_dr","word9_dr", "word10_dr", "comt_dr",
    
    "casi_score", "casi2_score", "c14_overall", "c14_secg",
    
    "condition1", "condition2", "condition3", "condition4", "condition5", "condition6", "condition7", "condition8", "condition9", "condition10", "condition11", "condition12", "condition13", "condition14", "condition15"
  ) %>%
  
  mutate(
    degree = factor(degree, labels = c("Grade school or less", 
                                       "Some high school", 
                                       "High school or G.E.D.", 
                                       "Some college or technical school",
                                       "College graduate (Bachelor's degree)",
                                       "Graduate degree (Master's, Doctoral, or Professional degree)"))


,
    gender = factor(gender, labels = c("Male",
                                       "Female")),
    country = as.character(country),
    country = recode(country, 
                       "156" = "China", 
                       "410" = "South Korea", 
                       "124" = "Canada", 
                       "344" = "Hong Kong", 
                       "158" = "Taiwan", 
                       "360" = "Indonesia", 
                       "458" = "Malaysia", 
                       "888" = "Other", 
                       "704" = "Vietnam" )
  )
```

A second dataset was created selecting only demographic variables, score variables, and potential confounders

```{r}
acad_clean_2 = acad_clean %>%
  select(
  "acad_id", "age","degree", "gender", "country", "generation", 
    
  "parta_a2score",
    
  "cdr_sum", "cdrglob", "comport", "cdrlang",
    
  "fas", 
    
  "clock_t",
    
  "comt_t1", "comt_t2", "comt_t3","comt_d", "comt_dr",
    
  "casi_score", "casi2_score", "c14_overall", "c14_secg",
    
    "condition1", "condition2", "condition3", "condition4", "condition5", "condition6", "condition7", "condition8", "condition9", "condition10", "condition11", "condition12", "condition13", "condition14", "condition15"
  )
```

Excluded 11 subjects due to no dietary information available.
Excluded 17 subjects due to entire survey information available
Excluded 44 subjects due to no c14_overall and c14_secg information available.

```{r}
acad_clean_2 = acad_clean_2 %>%
  drop_na(parta_a2score) %>%
  drop_na(gender) %>%
  drop_na(c14_overall) %>%
  drop_na(c14_secg)
```

Combining casi and casi2 scores; categorizing dietary score; renaming condition variables 

```{r}
acad_clean_2 = acad_clean_2 %>%
  mutate(
  casi_score = ifelse(is.na(casi_score), 0, casi_score),
  casi2_score = ifelse(is.na(casi2_score), 0, casi2_score),
  casi_t_score = casi_score + casi2_score,
  
  medi_score = as.factor(ifelse(parta_a2score < 5, "low",
                           ifelse(parta_a2score < 9, "middle",
                         "high"))),

  hypertension = condition1,
  diabetes = condition2,
  cholesterol = condition3,
  myo_infarc = condition4,
  cong_heart_f = condition5,
  stroke = condition6, 
  head_injury = condition7,
  seizure = condition8,
  hiv = condition9,
  sleep_apnea = condition10,
  sleep_disorder = condition11,
  other_cog = condition12,
  covid = condition13,
  vac_covid = condition14,
  kidney = condition15,
  ) %>%
  
  select(-condition1, -condition2, -condition3, -condition4, -condition5, -condition6, -condition7, -condition8, -condition9, -condition10, -condition11, -condition12, -condition13, -condition14, -condition15, -casi_score, -casi2_score) %>%
  
select(
  "acad_id", "age", "gender", "country", "generation", "degree", "parta_a2score", "medi_score", "casi_t_score", everything()
)
```

Picking comorbidities:

```{r}
acad_clean_2 %>%
  group_by(hypertension) %>%
  summarise(n_obs = n())

acad_clean_2 %>%
  group_by(diabetes) %>%
  summarise(n_obs = n())

acad_clean_2 %>%
  group_by(cholesterol) %>%
  summarise(n_obs = n())

acad_clean_2 %>%
  group_by(myo_infarc) %>%
  summarise(n_obs = n())

acad_clean_2 %>%
  group_by(cong_heart_f) %>%
  summarise(n_obs = n())

acad_clean_2 %>%
  group_by(stroke) %>%
  summarise(n_obs = n())

acad_clean_2 %>%
  group_by(head_injury) %>%
  summarise(n_obs = n())

acad_clean_2 %>%
  group_by(seizure) %>%
  summarise(n_obs = n())

acad_clean_2 %>%
  group_by(hiv) %>%
  summarise(n_obs = n())

acad_clean_2 %>%
  group_by(sleep_apnea) %>%
  summarise(n_obs = n())

acad_clean_2 %>%
  group_by(sleep_disorder) %>%
  summarise(n_obs = n())

acad_clean_2 %>%
  group_by(other_cog) %>%
  summarise(n_obs = n())

acad_clean_2 %>%
  group_by(covid) %>%
  summarise(n_obs = n())

acad_clean_2 %>%
  group_by(vac_covid) %>%
  summarise(n_obs = n())

acad_clean_2 %>%
  group_by(kidney) %>%
  summarise(n_obs = n())
```

selected the top three comorbidities (cholesterol, hypertension, and diabetes). Dropped all remaining comorbidities. 

```{r}
acad_clean_2 = acad_clean_2 %>%
  select(-myo_infarc, -cong_heart_f, -stroke, -head_injury, -seizure, -hiv, -sleep_apnea, -sleep_disorder, -other_cog, -covid, -vac_covid, -kidney)

skimr::skim(acad_clean_2)
```

Final cleaned data set is comprised of 260 observations and 25 variables - 2 character, 3 factor, and 20 numeric.

## Data Analysis

Exposure variable: 

* medi_score

Outcome variables: 

* casi_t_score
* c14_overall
* c14_secg

Covariates: 

* age
* gender
* education level 
* cholesterol
* hypertension
* diabetes

###Summary tables

#### Overall demographic and clinical charactersitic table

```{r}
listVars = c("age", "gender", "degree", "country", "medi_score", "casi_t_score", "c14_overall", "c14_secg", "cholesterol", "hypertension", "diabetes")

catVars = c("gender", "degree", "country", "medi_score","c14_overall", "c14_secg", "cholesterol", "hypertension", "diabetes")

table1 = CreateTableOne(vars = listVars, data = acad_clean_2, factorVars = catVars)

table1

```

#### Demographic and clinical characteristics by Mediterranean diet score tertiles 

```{r}
listVars_1 = c("age", "gender", "degree", "country", "casi_t_score", "c14_overall", "c14_secg", "cholesterol", "hypertension", "diabetes")

table2 = CreateTableOne(listVars_1, data = acad_clean_2, factorVars = catVars, strata = c("medi_score"))

table2 
```


#### Demographic, clinical, and dietary characteristics for subjects by c14_overall (or c14_secg?)

```{r}
listVars_2 = c("age", "gender", "degree", "country", "casi_t_score", "c14_overall", "cholesterol", "hypertension", "diabetes")

table3 = CreateTableOne(listVars_2, data = acad_clean_2, factorVars = catVars, strata = c("c14_secg"))

table3
```


#### Chi-square test for association between exposure (medi_score) and outcome (c14_secg, c14_overall)

```{r}
acad_clean_2$medi_score = factor(acad_clean_2$medi_score, levels = c("low", "middle", "high"))

table(acad_clean_2$medi_score, acad_clean_2$c14_secg)
chisq.test(acad_clean_2$medi_score, acad_clean_2$c14_secg)

table(acad_clean_2$medi_score, acad_clean_2$c14_overall)
chisq.test(acad_clean_2$medi_score, acad_clean_2$c14_overall)
```

#### Logsitic regression for medi_score and outcome (c14_secg)

```{r}
logit_1 = glm(c14_secg ~ medi_score, data = acad_clean_2, family = "binomial")
summary(logit_1)
```

* Also controlling for age, gender, education, condition(?)

```{r}
logit_2 = glm(c14_secg ~ medi_score + age + gender + degree + cholesterol + diabetes + hypertension, data = acad_clean_2, family = "binomial")
summary(logit_2)
```


#### ANOVA test for association between exposure (medi_score) and outcome (casi_t_score)

```{r}
one.way = aov(casi_t_score ~ medi_score, data = acad_clean_2)
summary(one.way)
```

#### Linear regression for medi_score and outcome (casi_t_score)

```{r}
linear_1 = lm(casi_t_score ~ medi_score, data = acad_clean_2)
summary(linear_1)
```

* Also controlling for age, gender, education, condition(?)

```{r}
linear_2 = lm(casi_t_score ~ medi_score + age + gender + degree + cholesterol + diabetes + hypertension, data = acad_clean_2)
summary(linear_2)
```




